<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G·ª≠i √Ånh Ng·ªçc ‚ú®</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Nunito:wght@400;600;700&family=Pacifico&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root { --primary-pink: #ff9a9e; --secondary-purple: #a18cd1; --soft-bg: linear-gradient(120deg, #fccb90 0%, #d57eeb 100%); --glass-bg: rgba(255, 255, 255, 0.75); --glass-border: 1px solid rgba(255, 255, 255, 0.9); --shadow-soft: 0 10px 40px rgba(0,0,0,0.1); }
        body { margin: 0; padding: 0; overflow-x: hidden; font-family: 'Quicksand', sans-serif; background: linear-gradient(135deg, #fff1eb 0%, #ace0f9 100%); background-size: 400% 400%; animation: gradientMove 15s ease infinite; min-height: 100vh; cursor: url('https://cur.cursors-4u.net/nature/nat-10/nat984.cur'), auto; position: relative; transition: background 2s ease; }
        @keyframes gradientMove { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .heart-bubble { position: absolute; width: 20px; height: 20px; background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ff6b81"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>'); background-size: contain; opacity: 0; animation: floatUp 4s ease-in forwards; z-index: 1; }
        @keyframes floatUp { 0% { transform: translateY(0) scale(0.5); opacity: 0; } 10% { opacity: 0.8; } 90% { opacity: 0.8; } 100% { transform: translateY(-100vh) scale(1.2); opacity: 0; } }
        .sparkle { position: absolute; width: 6px; height: 6px; background: #ff6b81; border-radius: 50%; pointer-events: none; z-index: 9999; animation: sparkleAnim 1s linear forwards; }
        @keyframes sparkleAnim { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(0) translate(15px, 15px); opacity: 0; } }
        .cursor-trail { position: absolute; width: 10px; height: 10px; background: rgba(255, 154, 158, 0.6); border-radius: 50%; pointer-events: none; z-index: 9998; transition: transform 0.1s; }
        #floating-layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; overflow: hidden; }
        .float-item { position: absolute; bottom: -60px; font-size: 2rem; opacity: 0.7; animation: floatUpAnimation linear forwards; }
        @keyframes floatUpAnimation { 0% { transform: translateY(0) rotate(0deg); opacity: 0; } 10% { opacity: 0.8; } 100% { transform: translateY(-110vh) rotate(360deg); opacity: 0; } }
        .sticker-photo { position: fixed; width: 110px; height: 110px; object-fit: cover; border-radius: 20px; border: 4px solid #fff; box-shadow: 0 8px 20px rgba(0,0,0,0.1); z-index: 2; opacity: 0.9; animation: stickerFloat 6s ease-in-out infinite; transition: opacity 1s; }
        .sticker-photo:hover { transform: scale(1.15) rotate(0) !important; opacity: 1; z-index: 50; }
        @keyframes stickerFloat { 0%, 100% { transform: translateY(0) rotate(-3deg); } 50% { transform: translateY(-15px) rotate(3deg); } }
        #loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff5f7; z-index: 10000; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .heart-beat { font-size: 4rem; color: #ff6b81; animation: beat 1s infinite; }
        @keyframes beat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
        .loading-progress { width: 200px; height: 6px; background: #eee; border-radius: 10px; margin-top: 15px; overflow: hidden; }
        .progress-bar { height: 100%; background: #ff6b81; width: 0%; transition: width 0.2s; }
        #trap-section { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; display: flex; justify-content: center; align-items: center; transition: opacity 0.6s; }
        .glass-box { background: var(--glass-bg); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border: var(--glass-border); padding: 3rem; border-radius: 40px; box-shadow: var(--shadow-soft); max-width: 650px; width: 90%; text-align: center; position: relative; z-index: 10; }
        .typing-container { min-height: 3.5rem; display: flex; justify-content: center; align-items: center; }
        .title-text { font-family: 'Dancing Script', cursive; font-size: 3.5rem; background: linear-gradient(to right, #ff6b81, #ff9a9e); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0; padding: 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.05); }
        .cursor-blink { display: inline-block; width: 3px; height: 3rem; background-color: #ff6b81; margin-left: 5px; animation: blink 1s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
        .desc-text { font-size: 1.25rem; color: #555; margin-bottom: 30px; line-height: 1.7; font-weight: 600; min-height: 100px; }
        .btn-action { font-size: 1.2rem; padding: 12px 40px; border-radius: 50px; border: none; font-weight: 700; cursor: pointer; position: relative; z-index: 20; font-family: 'Quicksand', sans-serif; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .btn-yes { background: linear-gradient(45deg, #ff6b81, #ff9a9e); color: white; transition: all 0.3s; }
        .btn-yes:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(255, 107, 129, 0.4); }
        .btn-no { background: white; color: #888; border: 2px solid #eee; margin-left: 20px; transition: none !important; }
        .funny-gif { max-width: 220px; border-radius: 20px; margin: 10px auto; border: 4px solid white; transform: rotate(-3deg); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        #album-section { display: none; padding: 80px 20px; position: relative; z-index: 10; }
        .shop-title { text-align: center; margin-bottom: 40px; }
        .badge-cute { background: #ff6b81; color: white; padding: 6px 20px; border-radius: 30px; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 2px; box-shadow: 0 4px 10px rgba(255, 107, 129, 0.3); }
        .grid-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(270px, 1fr)); gap: 30px; max-width: 1200px; margin: 0 auto; }
        .item-card { background: rgba(255,255,255,0.9); border-radius: 25px; overflow: hidden; box-shadow: 0 10px 20px rgba(0,0,0,0.05); transition: all 0.4s ease; cursor: pointer; border: 3px solid white; }
        .item-card:hover { transform: translateY(-10px) rotate(1deg); border-color: #ff9a9e; box-shadow: 0 20px 40px rgba(255, 154, 158, 0.2); }
        .item-img-box { height: 260px; overflow: hidden; position: relative; }
        .item-img-box img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .item-card:hover .item-img-box img { transform: scale(1.1); }
        .overlay-text { position: absolute; bottom: 10px; right: 10px; background: rgba(255,255,255,0.9); padding: 5px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: bold; color: #ff6b81; opacity: 0; transform: translateY(10px); transition: 0.3s; }
        .item-card:hover .overlay-text { opacity: 1; transform: translateY(0); }
        .item-info { padding: 15px; text-align: center; }
        .item-name { font-weight: 700; color: #444; font-size: 1.15rem; }
        #custom-success-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 20000; display: none; justify-content: center; align-items: center; }
        .success-card { background: #fff; width: 90%; max-width: 450px; border-radius: 30px; padding: 0; overflow: hidden; text-align: center; position: relative; animation: zoomInBounce 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55); box-shadow: 0 20px 50px rgba(0,0,0,0.3); }
        @keyframes zoomInBounce { 0% { transform: scale(0); opacity: 0; } 70% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); } }
        .success-header { background: linear-gradient(135deg, #ff9a9e 0%, #ff6b81 100%); padding: 55px; color: white; }
        .success-body { padding: 30px 20px; }
        .success-gif { width: 150px; height: 150px; object-fit: cover; border-radius: 50%; border: 5px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.2); margin-top: -80px; background: white; }
        .success-title { font-family: 'Pacifico'; font-size: 2rem; color: #ff6b81; margin: 15px 0 10px; }
        .success-msg { color: #555; font-size: 1.1rem; line-height: 1.5; margin-bottom: 25px; }
        .btn-ok-cute { background: #ff6b81; color: white; border: none; padding: 12px 40px; border-radius: 50px; font-weight: bold; font-size: 1.1rem; cursor: pointer; box-shadow: 0 5px 15px rgba(255, 107, 129, 0.4); transition: 0.2s; }
        .btn-ok-cute:hover { transform: scale(1.05); background: #ff4757; }
        
        #envelope-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 15000; display: none; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .env-wrapper { position: relative; width: 320px; height: 220px; cursor: pointer; margin-top: 100px; }
        .envelope { position: absolute; width: 100%; height: 100%; background: #ff9a9e; border-bottom-left-radius: 10px; border-bottom-right-radius: 10px; box-shadow: 0 20px 40px rgba(0,0,0,0.2); z-index: 2; overflow: visible; }
        .envelope::after { content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 0; border-style: solid; border-width: 0 160px 110px 160px; border-color: transparent transparent #ff8a90 transparent; z-index: 3; border-bottom-left-radius: 10px; border-bottom-right-radius: 10px; }
        .envelope::before { content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 0; border-style: solid; border-width: 110px 160px 110px 160px; border-color: transparent #ffb5b9 transparent #ffb5b9; z-index: 2; border-bottom-left-radius: 10px; border-bottom-right-radius: 10px; }
        .lid { position: absolute; top: 0; left: 0; width: 100%; height: 50%; z-index: 4; transform-origin: top; transition: transform 0.8s ease-in-out, z-index 0.2s 0.4s; }
        .lid::after { content: ''; position: absolute; top: 0; left: 0; width: 0; height: 0; border-style: solid; border-width: 110px 160px 0 160px; border-color: #ff9a9e transparent transparent transparent; }
        .letter-paper { position: absolute; top: 10px; left: 5%; width: 90%; height: 90%; background: #fff; border-radius: 10px; padding: 20px; z-index: 1; transition: all 1s ease-in-out 0.4s; box-shadow: 0 -5px 15px rgba(0,0,0,0.1); display: flex; flex-direction: column; align-items: center; }
        .open-envelope .lid { transform: rotateX(180deg); z-index: 1; }
        .open-envelope .letter-paper { transform: translateY(-280px); height: 400px; z-index: 5; }
        .letter-content { width: 100%; height: 100%; display: flex; flex-direction: column; opacity: 0; transition: opacity 0.5s 1s; }
        .open-envelope .letter-content { opacity: 1; }
        .letter-title { font-family: 'Dancing Script', cursive; font-size: 2rem; color: #ff6b81; text-align: center; margin-bottom: 10px; }
        .letter-note { font-size: 0.95rem; color: #666; text-align: center; margin-bottom: 15px; }
        .cute-input { width: 100%; border: 2px dashed #ffb5b9; border-radius: 15px; padding: 15px; font-family: 'Nunito', sans-serif; resize: none; flex-grow: 1; outline: none; background: #fffafa; color: #555; font-size: 1rem; transition: border-color 0.3s; }
        .cute-input:focus { border-color: #ff6b81; background: #fff; }
        .cute-input::placeholder { color: #ccc; font-style: italic; }
        .btn-send-letter { background: #ff6b81; color: white; border: none; padding: 10px 30px; border-radius: 50px; margin-top: 15px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 10px rgba(255,107,129,0.3); transition: 0.3s; align-self: center; }
        .btn-send-letter:hover { transform: scale(1.05); background: #ff4757; }
        .btn-send-letter:disabled { background: #ccc; transform: none; cursor: not-allowed; } 

        .music-btn { position: fixed; bottom: 25px; right: 25px; width: 60px; height: 60px; background: white; border-radius: 50%; box-shadow: 0 5px 25px rgba(255,107,129,0.3); display: flex; justify-content: center; align-items: center; color: #ff6b81; cursor: pointer; z-index: 9999; font-size: 1.3rem; border: 2px solid #ff9a9e; transition: transform 0.3s; }
        .music-btn:hover { transform: scale(1.1) rotate(10deg); }
        .music-rotating { animation: spinMusic 4s linear infinite; }
        @keyframes spinMusic { 100% { transform: rotate(360deg); } }
        .modal-content { border-radius: 30px; border: none; }
        .carousel-item img { object-fit: cover; border-radius: 20px; }
        .modal-body-custom { padding: 25px; background: white; border-radius: 30px 30px 0 0; margin-top: -25px; position: relative; }

        .btn-custom-req {
            position: fixed; bottom: 25px; left: 25px; 
            padding: 12px 25px;
            background: #fff; border: 2px solid #ff9a9e;
            border-radius: 50px; color: #ff6b81;
            font-weight: bold; cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            z-index: 9999; transition: all 0.3s;
            display: none;
        }
        .btn-custom-req:hover { background: #ff9a9e; color: white; transform: translateY(-3px); }

        #night-sky {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 30000; pointer-events: none; opacity: 0; transition: opacity 2s;
            background: url('https://wallpapers.com/images/hd/city-background-67ymlv38i2n66bvd.jpg') no-repeat center center;
            background-size: cover;
            overflow: hidden;
        }
        #night-sky::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 12, 41, 0.7); z-index: 1;
        }

        #fireworksCanvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 5; }
        
        .night-message {
            position: absolute; top: 20%; left: 50%; transform: translateX(-50%);
            font-family: 'Pacifico', cursive; color: rgba(255,255,255,0.95);
            font-size: 2.2rem; text-align: center; pointer-events: none;
            text-shadow: 0 0 15px #ff9a9e; z-index: 10;
            animation: floatMsg 4s ease-in-out infinite;
            width: 80%;
        }
        @keyframes floatMsg { 0%,100% { transform: translate(-50%, 0); } 50% { transform: translate(-50%, -10px); } }

        .moon {
            position: absolute; top: 50px; right: 50px; width: 100px; height: 100px;
            background: url('https://www.pngall.com/wp-content/uploads/2016/03/Moon-PNG-File.png');
            background-size: contain; z-index: 4; filter: drop-shadow(0 0 25px #ffffffee);
        }
        
        .night-controls {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            z-index: 50; display: flex; gap: 10px; pointer-events: auto; flex-wrap: wrap; justify-content: center; width: 90%;
        }
        .btn-night {
            background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.5);
            color: white; padding: 12px 25px; border-radius: 30px;
            backdrop-filter: blur(5px); cursor: pointer; transition: 0.3s;
            font-family: 'Quicksand'; font-weight: bold; font-size: 1rem;
            white-space: nowrap;
        }
        .btn-night:hover { background: rgba(255,255,255,0.4); transform: scale(1.05); box-shadow: 0 0 15px rgba(255,255,255,0.3); }
        .btn-night.active { background: #ff9a9e; color: #fff; border-color: #ff9a9e; box-shadow: 0 0 20px #ff9a9e; }

        .star-twinkle {
            position: absolute; width: 2px; height: 2px; background: white; border-radius: 50%;
            animation: twinkle infinite; opacity: 0; z-index: 1;
        }
        @keyframes twinkle { 0%, 100% { opacity: 0; box-shadow: 0 0 0 #fff; } 50% { opacity: 1; box-shadow: 0 0 5px #fff, 0 0 10px #fff; } }

        .shooting-star {
            position: absolute; top: 50%; left: 50%; height: 2px;
            background: linear-gradient(-45deg, rgba(95, 145, 255, 1), rgba(0, 0, 255, 0));
            filter: drop-shadow(0 0 6px rgba(105, 155, 255, 1));
            animation: tail 3s ease-in-out infinite, shooting 3s ease-in-out infinite;
            opacity: 0; z-index: 2;
        }
        .shooting-star::before {
            content: ''; position: absolute; top: calc(50% - 1px); right: 0; height: 2px;
            background: linear-gradient(-45deg, rgba(0, 0, 255, 0), rgba(95, 145, 255, 1), rgba(0, 0, 255, 0));
            transform: translateX(50%) rotateZ(45deg); border-radius: 100%;
            animation: shining 3s ease-in-out infinite;
        }
        .shooting-star::after {
            content: ''; position: absolute; top: calc(50% - 1px); right: 0; height: 2px;
            background: linear-gradient(-45deg, rgba(0, 0, 255, 0), rgba(95, 145, 255, 1), rgba(0, 0, 255, 0));
            transform: translateX(50%) rotateZ(45deg); border-radius: 100%;
            animation: shining 3s ease-in-out infinite; transform: translateX(50%) rotateZ(-45deg);
        }
        @keyframes tail { 0% { width: 0; } 30% { width: 100px; } 100% { width: 0; } }
        @keyframes shining { 0% { width: 0; } 50% { width: 30px; } 100% { width: 0; } }
        @keyframes shooting { 0% { transform: translateX(0); opacity: 1; } 100% { transform: translateX(1000px); opacity: 0; } }

    </style>
</head>
<body>
    
    <div id="loading-overlay">
        <div class="heart-beat">üíñ</div>
        <div class="loading-text animate__animated animate__pulse animate__infinite" style="margin-top:15px; font-family: 'Pacifico'; color: #ff6b81; font-size: 1.5rem;">ƒêang t·∫£i nhaaaaaaa...</div>
        <div class="loading-progress"><div class="progress-bar"></div></div>
    </div>

    <img src="./AN4.png" class="sticker-photo" style="top: 12%; left: 8%;">
    <img src="./AN1.png" class="sticker-photo" style="top: 7%; right: 12%; animation-delay: 1s;">
    <img src="./AN2.png" class="sticker-photo" style="bottom: 18%; left: 10%; animation-delay: 2s;">
    <img src="./AN3.jpg" class="sticker-photo" style="bottom: 15%; left: 87%; animation-delay: 2s;">
    <div id="floating-layer"></div>
    
    <audio id="bgMusic" loop><source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-16.mp3" type="audio/mpeg"></audio>
    <div class="music-btn" id="toggleMusic" title="B·∫≠t nh·∫°c"><i class="fas fa-music"></i></div>

    <button id="btnCustomRequest" class="btn-custom-req animate__animated animate__bounceIn">
        <i class="fas fa-magic me-2"></i> H√¥ng th√≠ch m·∫•y con n√†y
    </button>

    <div id="trap-section">
        <div class="glass-box animate__animated animate__zoomIn">
            <div class="typing-container"><h1 id="typewriter-title" class="title-text"></h1><span class="cursor-blink"></span></div>
            <img src="./gif1.gif" alt="Funny Gif" class="funny-gif animate__animated animate__bounceIn" onerror="this.src='https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExM3Z5Zm14Z3Z5Zm14Z3Z5Zm14ZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Lq0h93752f6J9tijvr/giphy.gif'">
            <div id="typewriter-body" class="desc-text"></div>
            <div style="position: relative; min-height: 80px; display: flex; justify-content: center; align-items: center; gap: 15px;">
                <button id="btnYes" class="btn-action btn-yes">Oki ƒë·ªìng √Ω lun</button>
                <button id="btnNo" class="btn-action btn-no">H√¥ng th√®m</button>
            </div>
        </div>
    </div>

    <div id="album-section">
        <div class="container">
            <div class="shop-title animate__animated animate__fadeIn">
                <span class="badge-cute animate__animated animate__bounceIn animate__delay-1s">G√≥c qu√† t·∫∑ng ‚ù§Ô∏è</span>
                <h1 class="title-text" style="font-size: 3rem; margin-top: 10px;">G·∫•u B√¥ng Cute Ph√¥ Mai Que</h1>
                <p class="text-muted animate__animated animate__fadeInUp animate__delay-2s">Th√≠ch b√© n√†o th√¨ ch·ªçn b√© ƒë√≥ nha (B·∫•m v√†o ƒë·ªÉ xem th√™m ·∫£nh)</p>
                <div class="animate__animated animate__bounceIn animate__delay-3s" style="font-size: 2rem; margin-top: 15px;">üëáüõçÔ∏è‚ú®</div>
            </div>
            <div class="grid-container" id="gridGift"></div>
        </div>
    </div>

    <div class="modal fade" id="detailModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="position-relative p-2 bg-white">
                    <button type="button" class="btn-close position-absolute top-0 end-0 m-3 z-3 bg-white" data-bs-dismiss="modal"></button>
                    <div id="bearCarousel" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-inner" id="carouselInner"></div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#bearCarousel" data-bs-slide="prev"><span class="carousel-control-prev-icon bg-dark rounded-circle" aria-hidden="true"></span></button>
                        <button class="carousel-control-next" type="button" data-bs-target="#bearCarousel" data-bs-slide="next"><span class="carousel-control-next-icon bg-dark rounded-circle" aria-hidden="true"></span></button>
                    </div>
                </div>
                <div class="modal-body-custom">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h2 id="mName" class="fw-bold m-0" style="color: #ff6b81; font-family: 'Nunito';">T√™n G·∫•u</h2>
                        <span id="mTag" class="badge bg-info text-white">New</span>
                    </div>
                    <p id="mDesc" class="text-muted" style="font-size: 1.1rem; line-height: 1.6;">M√¥ t·∫£...</p>
                    <div class="row mt-4">
                        <div class="col-12">
                             <label class="small text-muted fw-bold">ƒê·ªô M·ªÅm M·∫°i</label>
                             <div class="progress mb-3" style="height: 8px; border-radius: 5px;"><div id="barSoft" class="progress-bar" style="width: 0%; background-color: #a18cd1;"></div></div>
                             <label class="small text-muted fw-bold">ƒê·ªô Cute</label>
                             <div class="progress" style="height: 8px; border-radius: 5px;"><div id="barCute" class="progress-bar" style="width: 0%; background-color: #ff9a9e;"></div></div>
                        </div>
                    </div>
                    <button id="btnConfirm" class="btn w-100 mt-4 py-3 rounded-pill fw-bold text-white" style="background: #ff6b81; font-size: 1.2rem; box-shadow: 0 8px 20px rgba(255, 107, 129, 0.4);"><i class="fas fa-paw me-2"></i> CH·ªêT B√â N√ÄY</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="customRequestModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0">
                    <h5 class="modal-title fw-bold" style="color: #ff6b81;">Order Ri√™ng Cho B√† Ng·ªçc üíñ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted">N·∫øu kh√¥ng ∆∞ng b√© n√†o ·ªü ngo√†i kia, Ng·ªçc ƒëi·ªÅn th√¥ng tin b√© g·∫•u m√† Ng·ªçc th√≠ch v√†o ƒë√¢y nha.</p>
                    <p class="fw-bold text-danger mb-3">L∆∞u √Ω: G·∫•u ph·∫£i t·ª´ 1m2+ m·ªõi ƒë∆∞·ª£c tui x√©t duy·ªát nha :v</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold text-secondary">T√™n G·∫•u / Lo·∫°i G·∫•u</label>
                        <input type="text" class="form-control rounded-pill p-3" id="customBearName" placeholder="V√≠ d·ª•: G·∫•u Lotso kh·ªïng l·ªì...">
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold text-secondary">M√¥ t·∫£ chi ti·∫øt / Link ·∫£nh</label>
                        <textarea class="form-control rounded-4 p-3" id="customBearDesc" rows="3" placeholder="M√†u s·∫Øc, link shopee, ho·∫∑c d·∫∑n d√≤ g√¨ ƒë√≥..."></textarea>
                    </div>
                </div>
                <div class="modal-footer border-0 justify-content-center pb-4">
                    <button type="button" id="btnSendCustom" class="btn rounded-pill px-5 py-2 text-white fw-bold" style="background: linear-gradient(45deg, #ff9a9e, #ff6b81);">
                        G·ª≠i Order Ngay üöÄ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="envelope-overlay">
        <div class="env-wrapper" id="envWrapper">
            <div class="envelope">
                <div class="lid"></div>
                <div class="letter-paper">
                    <div class="letter-content">
                        <div class="letter-title">X√°c nh·∫≠n qu√† üíñ</div>
                        <p class="letter-note">Oki, v·∫≠y l√† ch·ªët b√© <b><span id="letterBearName">...</span></b> nha.<br>B√† Ng·ªçc c√≥ mu·ªën nh·∫Øn nh·ªß hay y√™u c·∫ßu th√™m g√¨ th√¨ ghi v√¥ ƒë√¢y n√®:</p>
                        <textarea id="feedbackText" class="cute-input" placeholder="V√≠ d·ª•: G√≥i qu√† m√†u h·ªìng, t·∫∑ng k√®m th√™m k·∫πo..."></textarea>
                        <button id="btnSendFeedback" class="btn-send-letter">G·ª≠i cho H ngay üíå</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="custom-success-overlay">
        <div class="success-card">
            <div class="success-header"></div>
            <img src="https://media.giphy.com/media/MDJ9IbxxvDUQM/giphy.gif" alt="Happy Cat" class="success-gif">
            <div class="success-body">
                <h3 class="success-title">ƒê√£ nh·∫≠n t√≠n hi·ªáu! üì°</h3>
                <p class="success-msg" id="success-message-content">B√† Ng·ªçc ƒë√£ ch·ªçn <b>G·∫•u Brown</b>.<br>Ng·ªìi y√™n ƒë√≥, shipper si√™u c·∫•p ƒë√°ng y√™u s·∫Ω mang t·ªõi li·ªÅn!</p>
                <button class="btn-ok-cute" onclick="closeSuccessModal()">Oki h√≥ng nha ‚ù§Ô∏è</button>
            </div>
        </div>
    </div>

    <div id="night-sky">
        <div id="stars-container"></div>
        <div class="moon"></div>
        <div class="night-message">T·∫∑ng Ng·ªçc c·∫£ b·∫ßu tr·ªùi n√†y ƒë·ªÉ ngh·ªãch n√® ‚ú®<br><small style="font-size: 1rem; font-family: 'Quicksand';">Hi v·ªçng SAO BƒÇNG s·∫Ω lu√¥n th·ª±c hi·ªán nh·ªØng ƒêI·ªÄU ∆Ø·ªöC c·ªßa b√† nhen</small></div>
        <canvas id="fireworksCanvas"></canvas>
        <div class="night-controls">
            <button class="btn-night" id="btnAutoFirework"><i class="fas fa-fire me-2"></i> Auto B·∫Øn</button>
            <button class="btn-night" id="btnHeartRelease"><i class="fas fa-heart me-2"></i> Th·∫£ Tim Bay</button>
            <button class="btn-night" id="btnShootingStar"><i class="fas fa-meteor me-2"></i> G·ªçi Sao BƒÉng</button>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        const GOOGLE_FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSd0xumkcxtQrQN8Z9UPsFA-k12ZEnUvYCaAwF-oI7WgHsfIoQ/formResponse"; 
        const ID_TEN_GAU = "entry.750619238"; 
        const ID_LOI_NHAN = "entry.888788125";

        const gifts = [];
        const genericDescs = [
            "B√© n√†y si√™u m·ªÅm, √¥m c·ª±c th√≠ch lu√¥n √°.",
            "Nh√¨n m·∫∑t c∆∞ng x·ªâu, ƒë·∫£m b·∫£o Ng·ªçc s·∫Ω th√≠ch.",
            "L√¥ng m·ªãn m√†ng nh∆∞ nhung, √¥m ƒëi ng·ªß l√† h·∫øt b√†i.",
            "ƒê·ªô cute v√¥ ƒë·ªëi, nh√¨n l√† mu·ªën n·ª±ng ngay.",
            "Hi·ªÅn kh√¥ √†, nh√¨n ng·ªë ng·ªë d·ªÖ th∆∞∆°ng l·∫Øm.",
            "Em n√†y ƒëang hot trend ƒë√≥, nh√¨n c∆∞ng ha.",
            "M·ªÅm nh∆∞ k·∫πo b√¥ng g√≤n v·∫≠y, s·ªù v√†o l√† m√™.",
            "Nh√¨n c√°i m·∫∑t l√† th·∫•y gh√©t r·ªìi (gh√©t ki·ªÉu y√™u √°).",
            "B√© n√†y √¥m ·∫•m l·∫Øm nha, th√≠ch h·ª£p cho m√πa n√†y.",
            "D·ªÖ th∆∞∆°ng l·∫°c l·ªëi lu√¥n, r∆∞·ªõc em n√≥ v·ªÅ ƒëi."
        ];

        for (let i = 1; i <= 20; i++) {
            gifts.push({
                id: i,
                name: "G·∫•u S·ªë " + i,
                category: "all",
                tag: "Cute",
                desc: genericDescs[Math.floor(Math.random() * genericDescs.length)],
                stats: { 
                    soft: Math.floor(Math.random() * (100 - 85) + 85), 
                    cute: Math.floor(Math.random() * (100 - 85) + 85) 
                },
                gallery: [`./gau${i}.png`] 
            });
        }

        let selectedGift = null;
        let scaleYes = 1;
        const softNoTexts = ["K√¨ gh√™ √°", "Suy nghƒ© l·∫°i ƒëii", "B·∫•m l·ªôn h·∫£?", "N√∫t h∆∞ r·ªìi", "H√¥ng cho b·∫•m", "ƒê·ª´ng m√† ü•∫"];
        const softYesTexts = [
          "Ng·ªçc c·ª© t·ª´ t·ª´ ch·ªçn nha, tui ch·ªù ƒë∆∞·ª£c m√† ü´∂",
          "Kh√¥ng c·∫ßn g·∫•p ƒë√¢u, ch·ªçn m√≥n Ng·ªçc th√≠ch l√† ƒë∆∞·ª£c ü§ç",
          "Ng·ªçc th√≠ch g√¨ th√¨ c·ª© b·∫•m, tui tin gu Ng·ªçc √° üéÅ",
          "Tui ƒë·ªÉ Ng·ªçc ch·ªçn ƒë√≥, tho·∫£i m√°i nha üòå",
          "Kh√¥ng √°p l·ª±c g√¨ h·∫øt, ch·ªçn theo c·∫£m gi√°c c·ªßa Ng·ªçc th√¥i üå∑",
          "Coi nh∆∞ l√† m·ªôt ni·ªÅm vui nh·ªè, Ng·ªçc ch·ªçn gi√∫p tui nha ‚ú®",
          "Ng·ªçc th·∫•y m√≥n n√†o h·ª£p th√¨ ch·ªçn, tui ok h·∫øt üíù",
          "Ch·ªçn hay kh√¥ng c≈©ng ƒë∆∞·ª£c, quan tr·ªçng l√† Ng·ªçc vui ü´Ç",
          "Tui ch·ªâ mong Ng·ªçc th√≠ch, c√≤n l·∫°i ƒë·ªÉ tui lo ü§ç",
          "Ng·ªçc ch·ªçn nha, c√≤n tui ƒë·ª©ng ƒë√¢y ch·ªù n√® üòÑ"
        ];
        
        const titlePhrases = ["H·∫ø l√¥ √Ånh Ng·ªçc cute ph√¥ mai que", "Ch√†o ng∆∞·ªùi ƒë·∫πp r·∫°ng ng·ªùi", "Hello c√¥ n∆∞∆°ng xinh ƒë·∫πp"];
        let titleIndex = 0; let charIndex = 0; let isDeleting = false;
        
        function typeWriterTitle() {
            const currentPhrase = titlePhrases[titleIndex];
            const titleElement = document.getElementById("typewriter-title");
            if (isDeleting) { titleElement.innerHTML = currentPhrase.substring(0, charIndex - 1); charIndex--; } 
            else { titleElement.innerHTML = currentPhrase.substring(0, charIndex + 1); charIndex++; }
            let typeSpeed = 100; if (isDeleting) typeSpeed /= 2;
            if (!isDeleting && charIndex === currentPhrase.length) { typeSpeed = 2000; isDeleting = true; } 
            else if (isDeleting && charIndex === 0) { isDeleting = false; titleIndex = (titleIndex + 1) % titlePhrases.length; typeSpeed = 500; }
            setTimeout(typeWriterTitle, typeSpeed);
        }

        function typeWriterBody() {
            const bodyElement = document.getElementById("typewriter-body"); bodyElement.innerHTML = "";
            const lines = [
              "Kh√¥ng d·ªÖ ƒë√¢u, nh∆∞ng tui v·∫´n mu·ªën l√†m cho Ng·ªçc üí´",
              "Coi nh∆∞ ƒë√¢y l√† m·ªôt ch√∫t c·ªë g·∫Øng nh·ªè c·ªßa tui v·∫≠y ƒë√≥ ü´∂",
              "<b style='color:#ff6f91; font-size:18px;'>√Ånh Ng·ªçc ƒë√£ s·∫µn s√†ng ƒë·ªÉ ch·ªçn qu√† sinh nh·∫≠t ch∆∞aaaaaaa !üéÅ‚ú®</b>"
            ];
            lines.forEach((line, index) => {
                setTimeout(() => {
                    const p = document.createElement("div"); p.innerHTML = line; p.style.opacity = 0; p.style.transition = "opacity 1s";
                    bodyElement.appendChild(p); setTimeout(() => p.style.opacity = 1, 100);
                }, index * 1500);
            });
        }
        
        function createHeartBubbles() { setInterval(() => { const heart = document.createElement('div'); heart.classList.add('heart-bubble'); heart.style.left = Math.random() * 100 + 'vw'; heart.style.animationDuration = (Math.random() * 3 + 5) + 's'; document.body.appendChild(heart); setTimeout(() => heart.remove(), 8000); }, 500); }
        function startFloatingElements() { const icons = ['üß∏', 'üéÅ', 'üéÄ', '‚ú®', 'üíñ', 'üå∏', 'üç≠']; const container = document.getElementById('floating-layer'); setInterval(() => { const el = document.createElement('div'); el.classList.add('float-item'); el.innerText = icons[Math.floor(Math.random() * icons.length)]; el.style.left = Math.random() * 95 + 'vw'; el.style.animationDuration = (Math.random() * 5 + 10) + 's'; el.style.fontSize = (Math.random() * 1.5 + 1.5) + 'rem'; container.appendChild(el); setTimeout(() => el.remove(), 15000); }, 800); }
        function simulateLoading() { const progressBar = document.querySelector('.loading-progress .progress-bar'); let width = 0; const interval = setInterval(() => { if (width >= 100) { clearInterval(interval); $('#loading-overlay').fadeOut(600); setTimeout(() => { typeWriterTitle(); typeWriterBody(); }, 500); } else { width += Math.random() * 10 + 5; progressBar.style.width = Math.min(width, 100) + '%'; } }, 150); }

        $(window).on('load', function() { simulateLoading(); startFloatingElements(); createHeartBubbles(); });
        $(document).on('mousemove', function(e) { if(Math.random() < 0.3) { const sparkle = $('<div class="sparkle"></div>'); $('body').append(sparkle); sparkle.css({ left: e.pageX, top: e.pageY }); setTimeout(() => sparkle.remove(), 1000); } const trail = $('<div class="cursor-trail"></div>'); $('body').append(trail); trail.css({ left: e.pageX, top: e.pageY }); setTimeout(() => { trail.css({transform: 'scale(0)', opacity: 0}); setTimeout(() => trail.remove(), 200); }, 50); });

        $(document).ready(function() {
            $('#toggleMusic').click(function() { const audio = document.getElementById('bgMusic'); if(audio.paused) { audio.play(); $(this).addClass('music-rotating').css('color', '#ff6b81'); } else { audio.pause(); $(this).removeClass('music-rotating').css('color', '#ff9a9e'); } });
            
            $('#btnNo').on('mouseover click', function(e) { 
                e.preventDefault();
                const offsetX = (Math.random() - 0.5) * 250; const offsetY = (Math.random() - 0.5) * 250; $(this).css('transform', `translate(${offsetX}px, ${offsetY}px)`); $(this).text(softNoTexts[Math.floor(Math.random() * softNoTexts.length)]); scaleYes += 0.15; $('#btnYes').css('transform', `scale(${scaleYes})`); $('#btnYes').text(softYesTexts[Math.floor(Math.random() * softYesTexts.length)]); 
            });
            
            $('#btnYes').click(function() { 
                try { document.getElementById('bgMusic').play(); $('#toggleMusic').addClass('music-rotating'); } catch(e){} confetti({ particleCount: 150, spread: 100, origin: { y: 0.6 }, colors: ['#ff6b81', '#ff9a9e'] }); $('#trap-section').addClass('animate__animated animate__fadeOutUp'); 
                setTimeout(() => { 
                    $('#trap-section').hide(); $('#album-section').fadeIn(800).css('display', 'block'); $('#btnCustomRequest').fadeIn(); renderGifts(); 
                }, 800); 
            });
            
            $('#btnConfirm').click(function() {
                $('#detailModal').modal('hide');
                $('#letterBearName').text(selectedGift ? selectedGift.name : 'G·∫•u ch∆∞a t√™n');
                $('#feedbackText').val('');
                $('#envelope-overlay').css('display', 'flex').hide().fadeIn(500);
                setTimeout(() => { $('#envWrapper').addClass('open-envelope'); }, 800);
            });

            $('#btnSendFeedback').click(function() {
                const $btn = $(this);
                const userNote = $('#feedbackText').val(); 
                const bearName = selectedGift ? selectedGift.name : "Kh√¥ng r√µ";

                $btn.prop('disabled', true).html('<i class="fas fa-spinner fa-spin"></i> ƒêang g·ª≠i...');

                const finalUrl = `${GOOGLE_FORM_URL}?${ID_TEN_GAU}=${encodeURIComponent(bearName)}&${ID_LOI_NHAN}=${encodeURIComponent(userNote)}`;

                fetch(finalUrl, { method: 'POST', mode: 'no-cors' })
                .then(() => {
                    setTimeout(() => {
                        $('#envelope-overlay').fadeOut(500, function() { $('#envWrapper').removeClass('open-envelope'); });
                        let finalMsg = `B√† Ng·ªçc ƒë√£ ch·ªët ƒë∆°n b√© <b>${bearName}</b> r·ªìi nha.<br>`;
                        if(userNote.trim() !== "") finalMsg += `V√† l·ªùi nh·∫Øn nh·ªß: <i>"${userNote}"</i> ƒë√£ ƒë∆∞·ª£c l∆∞u l·∫°i.<br>`;
                        finalMsg += `H·∫πn b√† 1 ng√†y kh√¥ng xa khi b√† l√™n l·∫°i S√¨ G√≤n nha, shipper cute ph√¥ mai que g·ª≠i t·ªõi li·ªÅn! üõµüí®`;
                        
                        $('#success-message-content').html(finalMsg);
                        $('#custom-success-overlay').css('display', 'flex');
                        
                        var duration = 3 * 1000; var animationEnd = Date.now() + duration;
                        var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 20001 };
                        var interval = setInterval(function() { var timeLeft = animationEnd - Date.now(); if (timeLeft <= 0) return clearInterval(interval); var particleCount = 50 * (timeLeft / duration); confetti(Object.assign({}, defaults, { particleCount, origin: { x: Math.random(), y: Math.random() - 0.2 } })); }, 250);
                        
                        $btn.prop('disabled', false).text('G·ª≠i cho ai ƒë√≥ ngay üíå');
                    }, 1000);
                })
                .catch(err => {
                    alert("C√≥ l·ªói x√≠u xiu, ch·∫Øc m·∫°ng lag √°. B·∫•m g·ª≠i l·∫°i nha!");
                    $btn.prop('disabled', false).text('Th·ª≠ l·∫°i ƒëii ü•∫');
                });
            });

            $('#btnCustomRequest').click(function() {
                $('#customRequestModal').modal('show');
            });

            $('#btnSendCustom').click(function() {
                const bearName = $('#customBearName').val();
                const bearDesc = $('#customBearDesc').val();

                if(!bearName || !bearDesc) {
                    alert('Ng·ªçc ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin gi√∫p tui nha!');
                    return;
                }

                const $btn = $(this);
                $btn.prop('disabled', true).html('<i class="fas fa-spinner fa-spin"></i> ƒêang g·ª≠i...');
                const finalUrl = `${GOOGLE_FORM_URL}?${ID_TEN_GAU}=${encodeURIComponent("ORDER RI√äNG: " + bearName)}&${ID_LOI_NHAN}=${encodeURIComponent(bearDesc)}`;

                fetch(finalUrl, { method: 'POST', mode: 'no-cors' })
                .then(() => {
                    setTimeout(() => {
                        $('#customRequestModal').modal('hide');
                        let finalMsg = `ƒê√£ nh·∫≠n order ri√™ng c·ªßa Ng·ªçc: <b>${bearName}</b>.<br>`;
                        finalMsg += `M√¥ t·∫£: <i>"${bearDesc}"</i> ƒë√£ ƒë∆∞·ª£c l∆∞u l·∫°i ƒë·ªÉ tui ƒëi ki·∫øm.<br>`;
                        finalMsg += `Ch·ªù tin vui t·ª´ tui nha! ü•∞`;
                        
                        $('#success-message-content').html(finalMsg);
                        $('#custom-success-overlay').css('display', 'flex');
                        
                        var duration = 3 * 1000; var animationEnd = Date.now() + duration;
                        var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 20001 };
                        var interval = setInterval(function() { var timeLeft = animationEnd - Date.now(); if (timeLeft <= 0) return clearInterval(interval); var particleCount = 50 * (timeLeft / duration); confetti(Object.assign({}, defaults, { particleCount, origin: { x: Math.random(), y: Math.random() - 0.2 } })); }, 250);
                        
                        $btn.prop('disabled', false).html('G·ª≠i Order Ngay üöÄ');
                        $('#customBearName').val('');
                        $('#customBearDesc').val('');
                    }, 1000);
                })
                .catch(err => {
                    alert("L·ªói m·∫°ng r·ªìi, th·ª≠ l·∫°i gi√∫p tui nha!");
                    $btn.prop('disabled', false).html('Th·ª≠ l·∫°i ƒëii ü•∫');
                });
            });
        });

        function renderGifts() { 
            const container = $('#gridGift'); 
            container.empty(); 
            gifts.forEach(gift => { 
                container.append(`<div class="item-card animate__animated animate__zoomIn" onclick="showDetail(${gift.id})"><div class="item-img-box"><img src="${gift.gallery[0]}" alt="${gift.name}"></div><div class="overlay-text">B·∫•m xem üêæ</div><div class="item-info"><div class="item-name">${gift.name}</div></div></div>`); 
            }); 
        }
        
        window.showDetail = function(id) { 
            const gift = gifts.find(g => g.id === id); 
            selectedGift = gift; 
            $('#mName').text(gift.name); 
            $('#mTag').text(gift.tag); 
            $('#mDesc').text(gift.desc); 
            const carouselInner = $('#carouselInner'); 
            carouselInner.empty(); 
            gift.gallery.forEach((img, index) => { 
                carouselInner.append(`<div class="carousel-item ${index === 0 ? 'active' : ''}"><img src="${img}" class="d-block w-100"></div>`); 
            }); 
            $('#barSoft').css('width', '0%'); 
            $('#barCute').css('width', '0%'); 
            new bootstrap.Modal(document.getElementById('detailModal')).show(); 
            setTimeout(() => { 
                $('#barSoft').css('width', gift.stats.soft + '%'); 
                $('#barCute').css('width', gift.stats.cute + '%'); 
            }, 300); 
        }
        
        window.closeSuccessModal = function() { 
            $('#custom-success-overlay').fadeOut();
            startNightMode();
        }

        function startNightMode() {
            $('body').css('background', '#000');
            $('#album-section, #floating-layer, .sticker-photo, #btnCustomRequest').fadeOut(1000);
            $('#night-sky').css('pointer-events', 'auto').css('opacity', 1);
            
            const canvas = document.getElementById('fireworksCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const particles = [];
            const hearts = [];
            let autoFireworkInterval = null;
            let isAuto = false;
            let shootingStarInterval = null;
            let isShooting = false;

            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });

            for(let i=0; i<150; i++) {
                const star = document.createElement('div');
                star.className = 'star-twinkle';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 80 + '%';
                star.style.animationDelay = Math.random() * 5 + 's';
                star.style.animationDuration = Math.random() * 3 + 2 + 's';
                document.getElementById('stars-container').appendChild(star);
            }

            class Particle {
                constructor(x, y, color) {
                    this.x = x; this.y = y; this.color = color;
                    const power = Math.random() * 12 + 6; 
                    const angle = Math.random() * Math.PI * 2;
                    this.velocity = { x: Math.cos(angle) * power, y: Math.sin(angle) * power };
                    this.alpha = 1; this.friction = 0.95; this.gravity = 0.03;
                }
                draw() {
                    ctx.save();
                    ctx.globalAlpha = this.alpha;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, 2.5, 0, Math.PI * 2, false);
                    ctx.fillStyle = this.color;
                    ctx.fill();
                    ctx.restore();
                }
                update() {
                    this.velocity.x *= this.friction;
                    this.velocity.y *= this.friction;
                    this.velocity.y += this.gravity;
                    this.x += this.velocity.x;
                    this.y += this.velocity.y;
                    this.alpha -= 0.012;
                }
            }

            class Heart {
                constructor(x, y) {
                    this.x = x; this.y = y;
                    this.size = Math.random() * 15 + 10;
                    this.speedY = Math.random() * 1.5 + 0.5;
                    this.wobble = Math.random() * Math.PI * 2;
                    this.color = `hsla(${Math.random() * 50 + 330}, 100%, 70%, 0.9)`; 
                }
                draw() {
                    ctx.save();
                    ctx.translate(this.x, this.y);
                    ctx.fillStyle = this.color;
                    ctx.shadowBlur = 5; ctx.shadowColor = this.color;
                    ctx.beginPath();
                    ctx.moveTo(0, 0);
                    ctx.bezierCurveTo(-this.size/2, -this.size/2, -this.size, this.size/3, 0, this.size);
                    ctx.bezierCurveTo(this.size, this.size/3, this.size/2, -this.size/2, 0, 0);
                    ctx.fill();
                    ctx.restore();
                }
                update() {
                    this.y -= this.speedY;
                    this.wobble += 0.05;
                    this.x += Math.sin(this.wobble) * 0.8;
                }
            }

            class FairyDust {
                constructor(x, y) {
                    this.x = x; this.y = y;
                    this.size = Math.random() * 3;
                    this.color = `hsla(${Math.random() * 60 + 180}, 100%, 80%, 1)`;
                    this.velocity = { x: (Math.random() - 0.5), y: (Math.random() - 0.5) };
                    this.alpha = 1;
                }
                draw() {
                    ctx.save(); ctx.globalAlpha = this.alpha; ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = this.color; ctx.shadowBlur = 5; ctx.shadowColor = this.color;
                    ctx.fill(); ctx.restore();
                }
                update() {
                    this.x += this.velocity.x; this.y += this.velocity.y; this.alpha -= 0.05;
                }
            }
            const fairyDusts = [];
            canvas.addEventListener('mousemove', (e) => {
                for(let i=0; i<3; i++) fairyDusts.push(new FairyDust(e.clientX, e.clientY));
            });

            function createFirework(x, y) {
                const particleCount = 200; 
                const baseHue = Math.random() * 360;
                const baseColor = `hsl(${baseHue}, 100%, 60%)`;
                for (let i = 0; i < particleCount; i++) particles.push(new Particle(x, y, baseColor));
            }

            canvas.addEventListener('click', (e) => {
                createFirework(e.clientX, e.clientY);
            });

            function animate() {
                requestAnimationFrame(animate);
                
                ctx.globalCompositeOperation = 'destination-out';
                ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.globalCompositeOperation = 'source-over';
                
                fairyDusts.forEach((dust, i) => {
                    if(dust.alpha > 0) { dust.update(); dust.draw(); } else fairyDusts.splice(i, 1);
                });
                particles.forEach((particle, i) => {
                    if (particle.alpha > 0) { particle.update(); particle.draw(); } else particles.splice(i, 1);
                });
                hearts.forEach((heart, i) => {
                    if (heart.y > -50) { heart.update(); heart.draw(); } else hearts.splice(i, 1);
                });
            }
            animate();

            $('#btnAutoFirework').click(function() {
                isAuto = !isAuto;
                if(isAuto) {
                    $(this).addClass('active');
                    autoFireworkInterval = setInterval(() => {
                        const x = Math.random() * canvas.width;
                        const y = Math.random() * (canvas.height / 2);
                        createFirework(x, y);
                    }, 800);
                } else {
                    $(this).removeClass('active');
                    clearInterval(autoFireworkInterval);
                }
            });

            $('#btnHeartRelease').click(function() {
                for(let i=0; i<30; i++) { 
                    setTimeout(() => {
                        const x = Math.random() * canvas.width;
                        const y = canvas.height + Math.random() * 100;
                        hearts.push(new Heart(x, y));
                    }, i * 100);
                }
            });

            $('#btnShootingStar').click(function() {
                isShooting = !isShooting;
                if(isShooting) {
                    $(this).addClass('active');
                    shootingStarInterval = setInterval(() => {
                        const star = document.createElement('div');
                        star.className = 'shooting-star';
                        star.style.top = Math.random() * 50 + '%';
                        star.style.left = Math.random() * 100 + '%';
                        document.getElementById('night-sky').appendChild(star);
                        setTimeout(() => star.remove(), 3000);
                    }, 1500);
                } else {
                    $(this).removeClass('active');
                    clearInterval(shootingStarInterval);
                }
            });
        }
    </script>
</body>
</html>